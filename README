# üìä BI Case ‚Äî Yandex DataLens + SQL Views

–ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–∞—à–±–æ—Ä–¥–∞: –æ—Ç SQL-–º–æ–¥–µ–ª–µ–π –∏ –≤—ã—á–∏—Å–ª—è–µ–º—ã—Ö –ø–æ–ª–µ–π –¥–æ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π –≤ DataLens.

---

## üóÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

| –§–∞–π–ª                                                                     | –û–ø–∏—Å–∞–Ω–∏–µ                                                            |
| ------------------------------------------------------------------------ | ------------------------------------------------------------------- |
| [`02_sql_views.sql`](./02_sql_views.sql)                                 | SQL-–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –≤–∏—Ç—Ä–∏–Ω —Ñ–∞–∫—Ç–∞, –ø–ª–∞–Ω–æ–≤ –∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤           |
| [`03_datalens_calculated_fields.md`](./03_datalens_calculated_fields.md) | –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ –≤ Yandex DataLens –∏ —Ñ–æ—Ä–º—É–ª—ã –≤—ã—á–∏—Å–ª—è–µ–º—ã—Ö –ø–æ–ª–µ–π    |
| [`04_dashboard_checklist.md`](./04_dashboard_checklist.md)               | –ß–µ–∫-–ª–∏—Å—Ç –≥–æ—Ç–æ–≤—ã—Ö –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π –¥–ª—è —Ä–æ–ª–µ–π ¬´–ú–µ–Ω–µ–¥–∂–µ—Ä¬ª –∏ ¬´–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å¬ª |

---

## üß© 1. SQL Views

–§–∞–π–ª [`02_sql_views.sql`](./02_sql_views.sql) —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –≤–∏—Ç—Ä–∏–Ω –¥–∞–Ω–Ω—ã—Ö:

|  ‚Ññ  | –í–∏—Ç—Ä–∏–Ω–∞           | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                     |
| :-: | ----------------- | ---------------------------------------------- |
|  01 | **net_revenue**   | –ß–∏—Å—Ç–∞—è –≤—ã—Ä—É—á–∫–∞: –ø—Ä–æ–¥–∞–∂–∏ ‚àí –≤–æ–∑–≤—Ä–∞—Ç—ã             |
|  02 | **orders_margin** | –§–∞–∫—Ç –ø–æ –º–∞—Ä–∂–µ –∏–∑ –∑–∞–∫–∞–∑–æ–≤                       |
|  03 | **fact_enriched** | –û–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–π —Ñ–∞–∫—Ç —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ –∏ –∫–ª–∏–µ–Ω—Ç–∞–º–∏    |
|  04 | **plans_norm**    | –ü–ª–∞–Ω–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –ø–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º |
|  05 | **dim_clients**   | –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ —Å–≤—è–∑–∫–∞ —Å –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º–∏     |
|  06 | **dim_employees** | –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤                         |
|  07 | **dim_teams**     | –ö–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–ª–∏–¥, —É—á–∞—Å—Ç–Ω–∏–∫–∏, —Ä–æ–ª–∏)     |

üîó –í—Å–µ –≤–∏—Ç—Ä–∏–Ω—ã —Å–≤—è–∑–∞–Ω—ã –ø–æ –∫–ª—é—á–∞–º `client_id`, `sku`, `manager_id` –∏ `dt`.

---

## ‚öôÔ∏è 2. DataLens Dataset

[`03_datalens_calculated_fields.md`](./03_datalens_calculated_fields.md) –æ–ø–∏—Å—ã–≤–∞–µ—Ç:

* –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∏ —Å–≤—è–∑–∏ (`fact_enriched`, `plans_norm`, `dim_clients`, `dim_employees`, `dim_teams`);
* –∫–ª—é—á–µ–≤—ã–µ **Calculated Fields**:

  ```sql
  NET_REVENUE = sum([net_revenue])
  REVENUE_PLAN = sum([revenue_plan])
  REVENUE_PCT = if(REVENUE_PLAN = 0, NULL, NET_REVENUE / REVENUE_PLAN)
  AVG_CHECK_FACT = sum([net_revenue]) / countDistinct([client_id])
  ```
* —Ä–æ–ª–µ–≤—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã:

  * üë§ –ú–µ–Ω–µ–¥–∂–µ—Ä ‚Üí `[manager_id] = current_user`
  * üë• –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å ‚Üí `[lead_id] = current_user` (–≤—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –µ–≥–æ –∫–æ–º–∞–Ω–¥—ã)

---

## üìà 3. Dashboards Checklist

[`04_dashboard_checklist.md`](./04_dashboard_checklist.md) —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç –Ω–∞–±–æ—Ä –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π:

### –ú–µ–Ω–µ–¥–∂–µ—Ä

* **KPI:** –í—ã—Ä—É—á–∫–∞ / –ú–∞—Ä–∂–∞ / –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ (–§–∞–∫—Ç / –ü–ª–∞–Ω / %)
* **–õ–∏–Ω–∏—è:** –î–∏–Ω–∞–º–∏–∫–∞ ¬´–§–∞–∫—Ç vs –ü–ª–∞–Ω¬ª (–ø–æ –¥–Ω—è–º/–Ω–µ–¥–µ–ª—è–º)
* **–ë–∞—Ä:** –í—ã—Ä—É—á–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º (—Ç–æ–ø-5)
* **–ë–∞—Ä:** Top-20 –∞—Ä—Ç–∏–∫—É–ª–æ–≤ –ø–æ –≤—ã—Ä—É—á–∫–µ
* **–¢–∞–±–ª–∏—Ü–∞:** –ö–ª–∏–µ–Ω—Ç—ã –∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏

### –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å

* **KPI:** –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
* **–õ–∏–Ω–∏—è:** –î–∏–Ω–∞–º–∏–∫–∞ ¬´–§–∞–∫—Ç vs –ü–ª–∞–Ω¬ª –ø–æ –∫–æ–º–∞–Ω–¥–µ
* **–°—Ç–µ–∫-–±–∞—Ä:** –í—ã—Ä—É—á–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º √ó –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º
* **–¢–∞–±–ª–∏—Ü–∞:** ¬´–õ–∏–≥–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤¬ª —Å % –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–ª–∞–Ω–∞

---

## üß† –ü—Ä–∏–º–µ—Ä –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

* –ê–Ω–∞–ª–∏–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–ª–∞–Ω–∞ –ø—Ä–æ–¥–∞–∂ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º.
* –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –ø–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º.
* –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –¥–∏–Ω–∞–º–∏–∫–∏ –≤—ã—Ä—É—á–∫–∏ –≤ –∫–æ–º–∞–Ω–¥–µ.
* –ö–æ–Ω—Ç—Ä–æ–ª—å —Ç–æ–ø-–∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –∞—Ä—Ç–∏–∫—É–ª–æ–≤.

---

## üõ† –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

* **SQL:** PostgreSQL-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –≤–∏—Ç—Ä–∏–Ω.
* **BI:** [Yandex DataLens](https://datalens.yandex.ru/) –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π.
* **–†–æ–ª–∏:** –ú–µ–Ω–µ–¥–∂–µ—Ä / –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å (—á–µ—Ä–µ–∑ —Ä–æ–ª–µ–≤—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã).

---

## üìé –ê–≤—Ç–æ—Ä

**Artem Petrosyan**
Data Analyst / BI Developer
üìç –ú–æ—Å–∫–≤–∞ ‚Äî 2025
